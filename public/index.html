<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Zeabur Monitor</title>
  <link rel="icon" type="image/png" href="favicon.png">
  <script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.prod.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --card-opacity: 0.3;
    }
    @keyframes gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: url('bg.png') center/cover fixed;
      position: relative;
      min-height: 100vh;
      padding: 20px;
    }
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.05);
      z-index: 0;
    }
    .container { 
      max-width: 1400px; 
      margin: 0 auto; 
      position: relative;
      z-index: 1;
    }
    h1 {
      color: white;
      margin-bottom: 30px;
      font-size: 28px;
      font-weight: 700;
      text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    .refresh-btn {
      background: linear-gradient(135deg, #f696c6 0%, #fbb6d8 100%);
      color: white;
      border: 2px solid rgba(255,255,255,0.3);
      padding: 10px 20px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(246,150,198,0.3);
    }
    .refresh-btn:hover { 
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    }
    .refresh-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .account-card {
      background: rgba(255,255,255,var(--card-opacity));
      backdrop-filter: blur(var(--blur-amount)) saturate(var(--saturate-amount));
      -webkit-backdrop-filter: blur(var(--blur-amount)) saturate(var(--saturate-amount));
      border-radius: 20px;
      padding: 16px;
      margin-bottom: 10px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, var(--shadow-opacity));
      border: 1px solid rgba(255,255,255,var(--border-opacity));
      transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1), border-color 0.2s ease, z-index 0s 0.2s;
      animation: fadeInUp 0.6s ease-out;
      will-change: transform;
      transform: translate3d(0, 0, 0);
      position: relative;
      z-index: 1;
    }
    .account-card:hover {
      transform: translate3d(0, -8px, 0) scale(1.02);
      border-color: rgba(255,255,255,0.3);
      z-index: 10;
      transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1), border-color 0.2s ease, z-index 0s 0s;
    }
    .account-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      padding: 10px 8px;
      margin: -10px -8px 8px -8px;
      border-radius: 10px;
      transition: background 0.2s;
    }
    .account-header:hover {
      background: rgba(255,255,255,0.1);
    }
    .account-name {
      font-size: 16px;
      font-weight: 600;
      color: #333;
      line-height: 1.2;
    }
    .balance {
      font-size: 20px;
      font-weight: 700;
      color: #4CAF50;
      line-height: 1;
    }
    .balance.low { color: #ff9800; }
    .balance.critical { color: #f44336; }
    .projects-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }
    
    /* æ–°å¢çš„æ¨ªå‘æœåŠ¡å™¨å¸ƒå±€æ ·å¼ */
    .horizontal-servers-container {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-top: 20px;
    }
    
    .horizontal-server-card {
      background: rgba(255,255,255,var(--card-opacity));
      backdrop-filter: blur(var(--blur-amount)) saturate(var(--saturate-amount));
      -webkit-backdrop-filter: blur(var(--blur-amount)) saturate(var(--saturate-amount));
      border-radius: 16px;
      padding: 15px;
      min-width: 300px;
      flex: 1;
      box-shadow: 0 8px 32px rgba(0, 0, 0, var(--shadow-opacity));
      border: 1px solid rgba(255,255,255,var(--border-opacity));
      transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1), border-color 0.2s ease, z-index 0s 0.2s;
      animation: fadeInUp 0.6s ease-out;
      will-change: transform;
      transform: translate3d(0, 0, 0);
      position: relative;
      z-index: 1;
    }
    
    .horizontal-server-card:hover {
      transform: translate3d(0, -8px, 0) scale(1.02);
      border-color: rgba(255,255,255,0.3);
      z-index: 10;
      transition: transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1), border-color 0.2s ease, z-index 0s 0s;
    }
    
    .server-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      padding-bottom: 8px;
      border-bottom: 1px solid rgba(255,255,255,0.2);
    }
    
    .server-name {
      font-size: 16px;
      font-weight: 600;
      color: #333;
    }
    
    .server-usage {
      font-size: 14px;
      font-weight: 600;
      color: #4CAF50;
    }
    
    .server-address {
      font-size: 13px;
      color: #666;
      margin-bottom: 12px;
    }
    
    .server-stats {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 12px;
    }
    
    .stat-item {
      background: rgba(246, 150, 198, 0.2);
      padding: 4px 8px;
      border-radius: 6px;
      font-size: 11px;
      color: #333;
    }
    
    .server-projects {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    
    .project-item {
      background: rgba(255,255,255,0.15);
      border-radius: 10px;
      padding: 10px;
      border: 1px solid rgba(255,255,255,0.15);
    }
    
    .project-name {
      font-weight: 600;
      font-size: 14px;
      color: #333;
      margin-bottom: 4px;
    }
    
    .project-region {
      font-size: 11px;
      color: #666;
      margin-bottom: 4px;
    }
    
    .project-cost {
      font-size: 12px;
      color: #2196F3;
      font-weight: 600;
      margin-bottom: 6px;
    }
    
    .project-domains {
      margin: 6px 0;
    }
    
    .project-actions {
      display: flex;
      gap: 4px;
      margin-top: 6px;
    }
    @keyframes shimmer {
      0% { background-position: -1000px 0; }
      100% { background-position: 1000px 0; }
    }
    .project-card {
      background: rgba(255,255,255,var(--card-opacity));
      backdrop-filter: blur(var(--blur-amount-small)) saturate(var(--saturate-amount));
      -webkit-backdrop-filter: blur(var(--blur-amount-small)) saturate(var(--saturate-amount));
      border-radius: 12px;
      padding: 12px;
      border: 1px solid rgba(255,255,255,var(--border-opacity-light));
      position: relative;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      display: flex;
      flex-direction: column;
      min-height: auto;
      height: 100%;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0, 0, 0, var(--shadow-opacity));
    }
    .project-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -2px;
      right: -2px;
      bottom: 0;
      background: linear-gradient(135deg, #f696c6, #fbb6d8, #fdd7e8);
      border-radius: 16px;
      z-index: -1;
      opacity: 0;
      transition: opacity 0.4s;
    }
    .project-card:hover {
      transform: translateY(-4px) scale(1.02);
    }
    .project-card:hover::before {
      opacity: 1;
    }
    .project-name {
      font-weight: 600;
      font-size: 14px;
      color: #333;
      margin-bottom: 5px;
    }
    .project-name button:hover {
      background: rgba(246, 150, 198, 0.4) !important;
      transform: scale(1.1);
    }
    .project-info {
      font-size: 11px;
      color: #999;
      margin-bottom: 6px;
    }
    .service-item {
      background: rgba(255,255,255,var(--service-opacity));
      backdrop-filter: blur(var(--blur-amount-tiny)) saturate(var(--saturate-amount));
      -webkit-backdrop-filter: blur(var(--blur-amount-tiny)) saturate(var(--saturate-amount));
      padding: 8px 10px;
      margin: 4px 0;
      border-radius: 8px;
      transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      border: 1px solid rgba(255, 255, 255, var(--border-opacity-strong));
      min-height: auto;
      display: flex;
      flex-direction: column;
      gap: 6px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 1px 4px rgba(0, 0, 0, var(--shadow-opacity-light));
    }
    .service-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      transition: left 0.5s;
    }
    .service-item:hover {
      background: rgba(255,255,255,0.45);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
      transform: translateY(-2px);
      border-color: rgba(255, 255, 255, 0.6);
    }
    .service-item:hover::before {
      left: 100%;
    }
    .services-container {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.5);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }
    .modal-content {
      background: white;
      border-radius: 16px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    .modal-title {
      font-size: 24px;
      font-weight: 700;
      color: #333;
      margin-bottom: 20px;
    }
    .input-group {
      margin-bottom: 20px;
    }
    .input-label {
      display: block;
      font-size: 14px;
      font-weight: 600;
      color: #666;
      margin-bottom: 8px;
    }
    .input-field {
      width: 100%;
      padding: 12px 16px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      font-size: 14px;
      transition: all 0.3s;
    }
    .input-field:focus {
      outline: none;
      border-color: #f696c6;
      box-shadow: 0 0 0 3px rgba(246,150,198,0.1);
    }
    .btn-primary {
      background: linear-gradient(135deg, #f696c6 0%, #fbb6d8 100%);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      width: 100%;
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(246,150,198,0.4);
    }
    .btn-secondary {
      background: #f3f4f6;
      color: #666;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      width: 100%;
      margin-top: 10px;
    }
    .btn-secondary:hover {
      background: #e5e7eb;
    }
    .add-account-btn {
      background: rgba(255,255,255,0.2);
      color: white;
      border: 2px solid rgba(255,255,255,0.3);
      padding: 10px 20px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }
    .add-account-btn:hover {
      background: rgba(255,255,255,0.3);
      transform: translateY(-2px);
    }
    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      background: rgba(255,255,255,0.3);
      border-radius: 10px;
      height: 6px;
      outline: none;
    }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: white;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }
    input[type="range"]::-moz-range-thumb {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: white;
      cursor: pointer;
      border: none;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.7; }
    }
    .status {
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 10px;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
      position: relative;
      overflow: hidden;
      white-space: nowrap;
    }
    .status::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 100%;
      height: 100%;
      background: rgba(255,255,255,0.3);
      transform: translate(-50%, -50%) scale(0);
      border-radius: 50%;
      transition: transform 0.6s;
    }
    .status:hover::before {
      transform: translate(-50%, -50%) scale(2);
    }
    .status.running { 
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      color: white;
      animation: pulse 2s ease-in-out infinite;
    }
    .status.stopped { 
      background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
      color: white;
    }
    .status.suspended { 
      background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
      color: white;
    }
    .status.deploying { 
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
    }
    .status.paused { 
      background: linear-gradient(135deg, #4b6cb7 0%, #182848 100%);
      color: white;
    }
    .error {
      background: #ffebee;
      color: #c62828;
      padding: 15px;
      border-radius: 6px;
      margin-bottom: 15px;
    }
    .loading {
      text-align: center;
      padding: 40px;
      color: white;
      font-size: 16px;
    }
    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }
    .stat-box {
      padding: 10px;
      border-radius: 4px;
      text-align: center;
    }
    .stat-label {
      font-size: 12px;
      color: #666;
      margin-bottom: 5px;
    }
    .stat-value {
      font-size: 18px;
      font-weight: bold;
      color: #333;
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- åŠ å¯†å¯†é’¥æœªè®¾ç½®è­¦å‘Š -->
    <div v-if="showEncryptionWarning" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; z-index: 10001;">
      <div style="background: white; padding: 40px; border-radius: 16px; box-shadow: 0 8px 32px rgba(0,0,0,0.3); max-width: 600px; width: 95%;">
        <h2 style="text-align: center; color: #ff6b6b; margin-bottom: 15px;">âš ï¸ å®‰å…¨é…ç½®å¿…éœ€</h2>
        <p style="text-align: center; color: #666; font-size: 14px; margin-bottom: 20px;">
          ä¸ºäº†ä¿æŠ¤æ‚¨çš„ API Token å®‰å…¨,è¯·å…ˆè®¾ç½®åŠ å¯†å¯†é’¥
        </p>
        
        <div style="background: #fff3cd; border: 1px solid #ffc107; border-radius: 8px; padding: 15px; margin-bottom: 20px;">
          <div style="font-weight: 600; color: #856404; margin-bottom: 10px;">ğŸ“‹ è®¾ç½®æ­¥éª¤:</div>
          <ol style="color: #856404; font-size: 13px; line-height: 1.8; margin: 0; padding-left: 20px;">
            <li>å¤åˆ¶ä¸‹æ–¹ç”Ÿæˆçš„å¯†é’¥</li>
            <li>åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºæˆ–ç¼–è¾‘ <code style="background: #f8f9fa; padding: 2px 6px; border-radius: 4px;">.env</code> æ–‡ä»¶</li>
            <li>æ·»åŠ ä¸€è¡Œ: <code style="background: #f8f9fa; padding: 2px 6px; border-radius: 4px;">ACCOUNTS_SECRET=å¯†é’¥</code></li>
            <li>ä¿å­˜æ–‡ä»¶å¹¶é‡å¯æœåŠ¡</li>
          </ol>
        </div>
        
        <div style="margin-bottom: 20px;">
          <label style="display: block; font-size: 13px; font-weight: 600; color: #666; margin-bottom: 8px;">
            ğŸ” ä¸ºæ‚¨ä¸“å±ç”Ÿæˆçš„åŠ å¯†å¯†é’¥ (ç‚¹å‡»å¤åˆ¶):
          </label>
          <div style="font-size: 11px; color: #28a745; margin-bottom: 8px; font-weight: 500;">
            âœ¨ æ­¤å¯†é’¥ç”±åŠ å¯†å®‰å…¨éšæœºæ•°ç”Ÿæˆï¼Œå…¨çƒå”¯ä¸€ï¼Œè¯·å¦¥å–„ä¿ç®¡
          </div>
          <div 
            @click="copySecret" 
            style="background: #f8f9fa; border: 2px solid #e9ecef; border-radius: 8px; padding: 12px; font-family: monospace; font-size: 12px; word-break: break-all; cursor: pointer; transition: all 0.2s;"
            @mouseover="$event.target.style.borderColor='#f696c6'"
            @mouseout="$event.target.style.borderColor='#e9ecef'"
          >
            {{ suggestedSecret }}
          </div>
          <div style="font-size: 11px; color: #999; margin-top: 5px; text-align: center;">ç‚¹å‡»ä¸Šæ–¹å¯†é’¥å³å¯å¤åˆ¶</div>
        </div>
        
        <div style="background: #f8f9fa; border-radius: 8px; padding: 12px; margin-bottom: 20px;">
          <div style="font-size: 12px; color: #666; font-family: monospace;">
            <span style="color: #999;"># .env æ–‡ä»¶å†…å®¹ç¤ºä¾‹</span><br>
            ACCOUNTS_SECRET={{ suggestedSecret }}
          </div>
        </div>
        
        <div style="background: #d4edda; border: 1px solid #28a745; border-radius: 8px; padding: 12px; margin-bottom: 20px;">
          <div style="font-size: 12px; color: #155724;">
            <strong>ğŸ’¡ æç¤º:</strong> è®¾ç½®å®Œæˆå,åˆ·æ–°æ­¤é¡µé¢å³å¯ç»§ç»­ä½¿ç”¨ã€‚å¯†é’¥ç”¨äºåŠ å¯†å­˜å‚¨æ‚¨çš„ API Token,è¯·å¦¥å–„ä¿ç®¡ã€‚
          </div>
        </div>
        
        <button 
          @click="copySecret"
          style="width: 100%; padding: 12px; background: #f696c6; color: white; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer;"
        >
          ğŸ“‹ å¤åˆ¶å¯†é’¥åˆ°å‰ªè´´æ¿
        </button>
      </div>
    </div>
    
    <!-- é¦–æ¬¡è®¾ç½®å¯†ç ç•Œé¢ -->
    <div v-if="showSetPasswordModal" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 10000;">
      <div style="background: white; padding: 40px; border-radius: 16px; box-shadow: 0 8px 32px rgba(0,0,0,0.2); max-width: 400px; width: 90%;">
        <h2 style="text-align: center; color: #f696c6; margin-bottom: 10px;">ğŸ‰ æ¬¢è¿ä½¿ç”¨</h2>
        <p style="text-align: center; color: #666; font-size: 14px; margin-bottom: 30px;">è¯·è®¾ç½®ç®¡ç†å‘˜å¯†ç </p>
        <div style="margin-bottom: 20px;">
          <input 
            v-model="setPassword" 
            type="password" 
            placeholder="è¯·è¾“å…¥å¯†ç ï¼ˆè‡³å°‘6ä½ï¼‰"
            @keyup.enter="setAdminPassword"
            style="width: 100%; padding: 12px; border: 2px solid #f696c6; border-radius: 8px; font-size: 14px; outline: none;"
          />
        </div>
        <div style="margin-bottom: 20px;">
          <input 
            v-model="setPasswordConfirm" 
            type="password" 
            placeholder="è¯·å†æ¬¡è¾“å…¥å¯†ç "
            @keyup.enter="setAdminPassword"
            style="width: 100%; padding: 12px; border: 2px solid #f696c6; border-radius: 8px; font-size: 14px; outline: none;"
          />
        </div>
        <div v-if="setPasswordError" style="color: #c00; font-size: 13px; margin-bottom: 15px; text-align: center;">
          {{ setPasswordError }}
        </div>
        <button 
          @click="setAdminPassword"
          style="width: 100%; padding: 12px; background: #f696c6; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer;"
        >
          è®¾ç½®å¯†ç 
        </button>
      </div>
    </div>
    
    <!-- ç™»å½•ç•Œé¢ -->
    <div v-if="showLoginModal" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 10000;">
      <div style="background: white; padding: 40px; border-radius: 16px; box-shadow: 0 8px 32px rgba(0,0,0,0.2); max-width: 400px; width: 90%;">
        <h2 style="text-align: center; color: #f696c6; margin-bottom: 30px;">ğŸ” ç®¡ç†å‘˜ç™»å½•</h2>
        <div style="margin-bottom: 20px;">
          <input 
            v-model="loginPassword" 
            type="password" 
            placeholder="è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç "
            @keyup.enter="verifyPassword"
            style="width: 100%; padding: 12px; border: 2px solid #f696c6; border-radius: 8px; font-size: 14px; outline: none;"
          />
        </div>
        <div v-if="loginError" style="color: #c00; font-size: 13px; margin-bottom: 15px; text-align: center;">
          {{ loginError }}
        </div>
        <button 
          @click="verifyPassword"
          style="width: 100%; padding: 12px; background: #f696c6; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: 600; cursor: pointer;"
        >
          ç™»å½•
        </button>
      </div>
    </div>
    
    <div v-if="isAuthenticated" class="container">
      <h1>ğŸš€ Zeabur Monitor</h1>
      <div style="background: rgba(255,255,255,0.9); backdrop-filter: blur(10px); padding: 15px 18px; border-radius: 12px; margin-bottom: 15px; font-size: 13px; border: 1px solid rgba(255,255,255,0.3); box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
        <div style="font-weight: 700; margin-bottom: 8px; color: #f696c6;">ğŸ’¡ ä½¿ç”¨è¯´æ˜</div>
        <div style="line-height: 1.8; color: #555;">
          â€¢ æ•°æ®æ¯90ç§’è‡ªåŠ¨åˆ·æ–°
        </div>
      </div>
      
      <div style="display: flex; gap: 10px; margin-bottom: 20px; align-items: center; flex-wrap: wrap;">
        <button class="refresh-btn" @click="fetchData" :disabled="loading">
          {{ loading ? 'åŠ è½½ä¸­...' : 'ğŸ”„ åˆ·æ–°æ•°æ®' }}
        </button>
        <button class="add-account-btn" @click="showManageModal = true">
          âš™ï¸ ç®¡ç†è´¦å·
        </button>
        <button class="add-account-btn" @click="clearCache" style="background: rgba(255,100,100,0.3);">
          ğŸ—‘ï¸ æ¸…é™¤ç¼“å­˜
        </button>

        
        <!-- é€æ˜åº¦æ§åˆ¶ -->
        <div style="display: flex; align-items: center; gap: 10px; background: rgba(255,255,255,0.2); backdrop-filter: blur(10px); padding: 8px 16px; border-radius: 25px; border: 1px solid rgba(255,255,255,0.3);">
          <span style="color: white; font-size: 13px; font-weight: 600;">é€æ˜åº¦</span>
          <input 
            type="range" 
            v-model="opacity" 
            min="0" 
            max="100" 
            style="width: 100px; cursor: pointer;"
          />
          <span style="color: white; font-size: 13px; font-weight: 600; min-width: 35px;">{{ opacity }}%</span>
        </div>
        
        <span class="last-update-text" style="color: white; font-size: 14px; margin-left: auto; text-shadow: 0 2px 4px rgba(0,0,0,0.2);"></span>
          ä¸Šæ¬¡æ›´æ–°: {{ lastUpdate }}
        </span>
      </div>
      
      <!-- æ—¥å¿—æ¨¡æ€æ¡† -->
      <div v-if="showLogsModal" class="modal-overlay" @click.self="showLogsModal = false" style="z-index: 2000;">
        <div style="background: #1e1e1e; border-radius: 16px; width: 90%; max-width: 900px; height: 80vh; display: flex; flex-direction: column; box-shadow: 0 20px 60px rgba(0,0,0,0.5);">
          <div style="padding: 16px 20px; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center; flex-shrink: 0;">
            <h2 style="color: #f696c6; font-size: 16px; margin: 0;">ğŸ“‹ {{ logsModalTitle }}</h2>
            <button @click="showLogsModal = false" style="background: #444; color: #fff; border: none; width: 28px; height: 28px; border-radius: 6px; cursor: pointer; font-size: 16px; line-height: 1;">Ã—</button>
          </div>
          <div style="padding: 10px 20px; background: #264f78; color: #d4d4d4; font-size: 12px; display: flex; gap: 16px; flex-wrap: wrap; flex-shrink: 0;">
            <span>é¡¹ç›®: {{ logsModalInfo.project }}</span>
            <span>è´¦å·: {{ logsModalInfo.account }}</span>
            <span>æ—¥å¿—: {{ logsModalInfo.count }} æ¡</span>
            <span>æ—¶é—´: {{ logsModalInfo.time }}</span>
          </div>
          <div style="flex: 1; overflow-y: auto; padding: 12px 16px; min-height: 0;">
            <div v-if="logsLoading" style="text-align: center; padding: 40px; color: #888;">â³ æ­£åœ¨åŠ è½½æ—¥å¿—...</div>
            <pre v-else style="background: #252526; padding: 12px; border-radius: 8px; font-family: Consolas, Monaco, monospace; font-size: 12px; line-height: 1.5; white-space: pre-wrap; word-break: break-all; color: #d4d4d4; margin: 0; min-height: 100%;">{{ logsContent || 'æš‚æ— æ—¥å¿—' }}</pre>
          </div>
          <div style="padding: 12px 20px; border-top: 1px solid #333; text-align: right; flex-shrink: 0;">
            <button @click="showLogsModal = false" style="padding: 8px 20px; background: #f696c6; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; font-size: 13px;">å…³é—­</button>
          </div>
        </div>
      </div>

      <!-- è´¦å·ç®¡ç†æ¨¡æ€æ¡† -->
      <div v-if="showManageModal" class="modal-overlay" @mousedown.self="showManageModal = false">
        <div class="modal-content" style="max-width: 700px;">
          <div class="modal-title">âš™ï¸ è´¦å·ç®¡ç†</div>
          
          <!-- è´¦å·åˆ—è¡¨ -->
          <div style="margin-bottom: 20px;">
            <!-- æ˜¾ç¤ºæœ¬åœ°ç®¡ç†çš„è´¦å· -->
            <div v-for="(account, index) in managedAccounts" :key="'local-' + index" 
                 style="background: #f9fafb; padding: 15px; border-radius: 8px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
              <div style="flex: 1;">
                <div style="font-weight: 600; color: #333; margin-bottom: 4px;">{{ account.name }}</div>
                <div style="font-size: 12px; color: #999;">{{ maskEmail(account.email) || 'æœªçŸ¥é‚®ç®±' }}</div>
              </div>
              <button @click="removeAccount(index)" 
                      style="background: #fee; color: #c00; border: none; padding: 8px 16px; border-radius: 6px; cursor: pointer; font-size: 13px; font-weight: 600;">
                ğŸ—‘ï¸ åˆ é™¤
              </button>
            </div>
            
            <!-- æ˜¾ç¤ºæœåŠ¡å™¨é…ç½®çš„è´¦å·ï¼ˆåªè¯»ï¼‰ -->
            <div v-if="managedAccounts.length === 0 && accounts.length > 0">
              <div style="font-size: 12px; color: #666; margin-bottom: 10px; padding: 10px; background: #f0f9ff; border-radius: 6px;">
                ğŸ’¡ ä»¥ä¸‹è´¦å·æ¥è‡ªæœåŠ¡å™¨é…ç½®ï¼ˆ.env æ–‡ä»¶ï¼‰ï¼Œæ— æ³•åœ¨æ­¤åˆ é™¤
              </div>
              <div v-for="account in accounts" :key="'server-' + account.name" 
                   style="background: #f9fafb; padding: 15px; border-radius: 8px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
                <div style="flex: 1;">
                  <div style="font-weight: 600; color: #333; margin-bottom: 4px;">{{ account.name }}</div>
                  <div style="font-size: 12px; color: #999;">{{ account.data?.email || account.data?.username || 'æœåŠ¡å™¨é…ç½®' }}</div>
                </div>
                <span style="font-size: 12px; color: #999; padding: 6px 12px; background: #e5e7eb; border-radius: 6px;">
                  ğŸ”’ æœåŠ¡å™¨é…ç½®
                </span>
              </div>
            </div>
            
            <div v-if="managedAccounts.length === 0 && accounts.length === 0" style="text-align: center; color: #999; padding: 30px;">
              æš‚æ— è´¦å·ï¼Œç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ·»åŠ 
            </div>
          </div>
          
          <!-- æ·»åŠ æ–°è´¦å·è¡¨å• -->
          <div style="border-top: 2px solid #e5e7eb; padding-top: 20px;">
            <div style="font-weight: 600; margin-bottom: 15px; color: #f696c6;">â• æ·»åŠ æ–°è´¦å·</div>
            
            <div class="input-group">
              <label class="input-label">è´¦å·åç§°</label>
              <input 
                v-model="newAccount.name" 
                type="text" 
                class="input-field" 
                placeholder="ä¾‹å¦‚ï¼šæˆ‘çš„è´¦å·"
              />
            </div>
            
            <div class="input-group">
              <label class="input-label">API Token</label>
              <input 
                v-model="newAccount.token" 
                type="password" 
                class="input-field" 
                placeholder="sk-xxxxxxxxxxxxxxxx"
              />
            </div>
            
            <div v-if="addAccountError" style="background: #fee; color: #c00; padding: 10px; border-radius: 6px; margin-bottom: 15px; font-size: 13px;">
              {{ addAccountError }}
            </div>
            
            <div v-if="addAccountSuccess" style="background: #efe; color: #060; padding: 10px; border-radius: 6px; margin-bottom: 15px; font-size: 13px;">
              {{ addAccountSuccess }}
            </div>
            
            <button class="btn-primary" @click="addAccountToList" :disabled="addingAccount">
              {{ addingAccount ? 'éªŒè¯ä¸­...' : 'â• æ·»åŠ åˆ°åˆ—è¡¨' }}
            </button>
          </div>
          
          <!-- æ‰¹é‡æ·»åŠ  -->
          <div style="margin-top: 30px; padding-top: 30px; border-top: 2px dashed #e5e7eb;">
            <div style="font-weight: 600; color: #333; margin-bottom: 15px; font-size: 16px;">ğŸ“¦ æ‰¹é‡æ·»åŠ è´¦å·</div>
            <div style="margin-bottom: 10px; font-size: 13px; color: #666;">
              æ¯è¡Œä¸€ä¸ªè´¦å·ï¼Œæ”¯æŒæ ¼å¼ï¼š<code style="background: #f3f4f6; padding: 2px 6px; border-radius: 4px;">åç§°:Token</code> æˆ– <code style="background: #f3f4f6; padding: 2px 6px; border-radius: 4px;">åç§°ï¼šToken</code> æˆ– <code style="background: #f3f4f6; padding: 2px 6px; border-radius: 4px;">åç§°(Token)</code> æˆ– <code style="background: #f3f4f6; padding: 2px 6px; border-radius: 4px;">åç§°ï¼ˆTokenï¼‰</code>
            </div>
            <div style="position: relative; min-height: 120px;">
              <div style="width: 100%; min-height: 120px; padding: 12px; border: 2px solid transparent; border-radius: 8px; font-size: 13px; font-family: monospace; white-space: pre-wrap; word-break: break-all; pointer-events: none; color: #333; line-height: 1.5;">{{ maskedBatchAccounts }}</div>
              <textarea
                v-model="batchAccounts"
                @input="updateBatchDisplay"
                placeholder="æ¯è¡Œä¸€ä¸ªè´¦å·ï¼Œæ ¼å¼ï¼šè´¦å·åç§°:API_Token"
                style="width: 100%; min-height: 120px; padding: 12px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 13px; font-family: monospace; resize: vertical; outline: none; position: absolute; top: 0; left: 0; color: transparent; caret-color: black; background: transparent; line-height: 1.5;"
              ></textarea>
            </div>
            <div v-if="batchAddError" style="color: #c00; font-size: 13px; margin-top: 10px;">
              {{ batchAddError }}
            </div>
            <div v-if="batchAddSuccess" style="color: #0a0; font-size: 13px; margin-top: 10px;">
              {{ batchAddSuccess }}
            </div>
            <button 
              class="btn-primary" 
              @click="batchAddAccounts" 
              :disabled="addingAccount"
              style="margin-top: 15px;"
            >
              {{ addingAccount ? 'æ·»åŠ ä¸­...' : 'ğŸ“¦ æ‰¹é‡æ·»åŠ ' }}
            </button>
          </div>
          
          <button class="btn-secondary" @click="closeManageModal">
            å…³é—­
          </button>
        </div>
      </div>
      
      <!-- æ—§çš„æ·»åŠ è´¦å·æ¨¡æ€æ¡†ï¼ˆä¿ç•™å…¼å®¹ï¼‰ -->
      <div v-if="showAddModal" class="modal-overlay" @mousedown.self="showAddModal = false">
        <div class="modal-content">
          <div class="modal-title">â• æ·»åŠ  Zeabur è´¦å·</div>
          
          <div class="input-group">
            <label class="input-label">è´¦å·åç§°</label>
            <input 
              v-model="newAccount.name" 
              type="text" 
              class="input-field" 
              placeholder="ä¾‹å¦‚ï¼šæˆ‘çš„è´¦å·"
            />
          </div>
          
          <div class="input-group">
            <label class="input-label">API Token</label>
            <input 
              v-model="newAccount.token" 
              type="password" 
              class="input-field" 
              placeholder="sk-xxxxxxxxxxxxxxxx"
            />
            <div style="font-size: 12px; color: #999; margin-top: 6px;">
              åœ¨ Zeabur æ§åˆ¶å°çš„è®¾ç½®ä¸­åˆ›å»º API Token
            </div>
          </div>
          
          <div v-if="addAccountError" style="background: #fee; color: #c00; padding: 10px; border-radius: 6px; margin-bottom: 15px; font-size: 13px;">
            {{ addAccountError }}
          </div>
          
          <div v-if="addAccountSuccess" style="background: #efe; color: #060; padding: 10px; border-radius: 6px; margin-bottom: 15px; font-size: 13px;">
            {{ addAccountSuccess }}
          </div>
          
          <button class="btn-primary" @click="addAccount" :disabled="addingAccount">
            {{ addingAccount ? 'éªŒè¯ä¸­...' : 'æ·»åŠ è´¦å·' }}
          </button>
          
          <button class="btn-secondary" @click="closeAddModal">
            å–æ¶ˆ
          </button>
        </div>
      </div>
      
      <!-- æ¨ªå‘æœåŠ¡å™¨å¸ƒå±€å®¹å™¨ -->
      <div class="horizontal-servers-container">
        <div v-for="account in accounts" :key="account.name" class="horizontal-server-card">
          <!-- æœåŠ¡å™¨åç§°å’Œç”¨é‡ -->
          <div class="server-header">
            <div class="server-name">{{ account.name }}</div>
            <div v-if="account.data" class="server-usage">
              ${{ (account.data.credit / 100).toFixed(2) }}
            </div>
          </div>
          
          <!-- æœåŠ¡å™¨åœ°å€ -->
          <div class="server-address">
            <div v-if="account.data" style="color: #666; font-size: 14px;">
              {{ maskEmail(account.data.email) || account.data.username }}
            </div>
          </div>
          
          <!-- é¡¹ç›®ç»Ÿè®¡ -->
          <div class="server-stats">
            <div class="stat-item">
              <span>ğŸ“ é¡¹ç›®æ•°: {{ account.projects ? account.projects.length : 0 }}</span>
            </div>
            <div class="stat-item">
              <span>ğŸ”§ æœåŠ¡æ•°: {{ getTotalServices(account) }}</span>
            </div>
            <div class="stat-item">
              <span>âœ… è¿è¡Œä¸­: {{ getRunningServices(account) }}</span>
            </div>
          </div>
          
          <!-- é¡¹ç›®åˆ—è¡¨ -->
          <div class="server-projects">
            <div v-for="project in account.projects" :key="project._id" class="project-item">
              <div class="project-name">{{ project.name }}</div>
              <div class="project-region">ğŸ“ {{ project.region }}</div>
              <div class="project-cost">ğŸ’° ${{ formatCost(project.cost) }}</div>
              
              <!-- åŸŸååˆ—è¡¨ -->
              <div class="project-domains" v-if="getProjectDomains(project).length > 0">
                <a v-for="domainInfo in getProjectDomains(project)" 
                   :key="domainInfo.domain" 
                   :href="'https://' + domainInfo.domain" 
                   target="_blank"
                   style="display: flex; align-items: center; gap: 4px; padding: 4px 8px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; text-decoration: none; border-radius: 6px; font-size: 10px; font-weight: 600; margin-bottom: 4px; transition: all 0.2s;"
                   @mouseover="$event.target.style.transform = 'translateY(-1px)'"
                   @mouseout="$event.target.style.transform = 'translateY(0)'">
                  <span style="font-size: 12px;">ğŸŒ</span>
                  <span style="overflow: hidden; text-overflow: ellipsis; white-space: nowrap; flex: 1;">{{ domainInfo.domain }}</span>
                  <span v-if="domainInfo.isGenerated" style="background: rgba(255,255,255,0.25); padding: 1px 4px; border-radius: 4px; font-size: 9px;">è‡ªåŠ¨</span>
                </a>
              </div>
              
              <!-- ç®¡ç†å›¾æ ‡ -->
              <div class="project-actions">
                <button @click="showServiceLogs(account, project, null)" 
                        style="padding: 4px 8px; background: #af52de; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 10px; font-weight: 600; margin-right: 4px;">
                  ğŸ“‹ æ—¥å¿—
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- æ€»è§ˆç»Ÿè®¡ï¼ˆä¿ç•™åŸæ¥çš„ï¼‰ -->
      <div v-if="accounts.length > 0" class="account-card" :style="{
        background: isSummaryWhiteMode ? 'rgba(255, 255, 255, 0.95)' : 'rgba(246, 150, 198, 0.3)',
        backdropFilter: 'blur(20px) saturate(180%)',
        color: isSummaryWhiteMode ? '#333' : 'white',
        border: isSummaryWhiteMode ? '1px solid rgba(0,0,0,0.1)' : '1px solid rgba(255,255,255,0.3)',
        transition: 'all 0.3s ease'
      }">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
          <h3 style="font-size: 20px; font-weight: 700;">âœ¨ æ€»è§ˆ</h3>
          <button @click="toggleSummaryBackground" style="padding: 6px 12px; background: rgba(0,0,0,0.1); border: 1px solid rgba(0,0,0,0.2); border-radius: 8px; cursor: pointer; font-size: 12px; font-weight: 600; transition: all 0.2s;" :style="{ color: isSummaryWhiteMode ? '#666' : 'white' }">
            {{ isSummaryWhiteMode ? 'ğŸ¨ ç²‰åº•' : 'â¬œ ç™½åº•' }}
          </button>
        </div>
        <div class="stats">
          <div class="stat-box" :style="{ background: 'transparent', border: isSummaryWhiteMode ? '1px solid rgba(0,0,0,0.1)' : '1px solid rgba(255,255,255,0.2)' }">
            <div class="stat-label" :style="{ color: isSummaryWhiteMode ? '#666' : 'rgba(255,255,255,0.9)' }">è´¦å·æ•°</div>
            <div class="stat-value" style="color: #4ade80;">{{ accounts.length }}</div>
          </div>
          <div class="stat-box" :style="{ background: 'transparent', border: isSummaryWhiteMode ? '1px solid rgba(0,0,0,0.1)' : '1px solid rgba(255,255,255,0.2)' }">
            <div class="stat-label" :style="{ color: isSummaryWhiteMode ? '#666' : 'rgba(255,255,255,0.9)' }">é¡¹ç›®æ€»æ•°</div>
            <div class="stat-value" style="color: #4ade80;">{{ totalProjects }}</div>
          </div>
          <div class="stat-box" :style="{ background: 'transparent', border: isSummaryWhiteMode ? '1px solid rgba(0,0,0,0.1)' : '1px solid rgba(255,255,255,0.2)' }">
            <div class="stat-label" :style="{ color: isSummaryWhiteMode ? '#666' : 'rgba(255,255,255,0.9)' }">æœåŠ¡æ€»æ•°</div>
            <div class="stat-value" style="color: #4ade80;">{{ totalServices }}</div>
          </div>
          <div class="stat-box" :style="{ background: 'transparent', border: isSummaryWhiteMode ? '1px solid rgba(0,0,0,0.1)' : '1px solid rgba(255,255,255,0.2)' }">
            <div class="stat-label" :style="{ color: isSummaryWhiteMode ? '#666' : 'rgba(255,255,255,0.9)' }">è¿è¡Œä¸­</div>
            <div class="stat-value" style="color: #4ade80;">{{ runningServices }}</div>
          </div>
          <div class="stat-box" :style="{ background: 'transparent', border: isSummaryWhiteMode ? '1px solid rgba(0,0,0,0.1)' : '1px solid rgba(255,255,255,0.2)' }">
            <div class="stat-label" :style="{ color: isSummaryWhiteMode ? '#666' : 'rgba(255,255,255,0.9)' }">æ€»è´¹ç”¨</div>
            <div class="stat-value" style="color: #ef4444;">${{ totalCost.toFixed(2) }}</div>
          </div>
        </div>
      </div>
      
      <div v-if="loading && accounts.length === 0" class="loading">
        âš¡ æ­£åœ¨åŠ è½½æ•°æ®...
      </div>
      </div>
      
      <div v-if="!loading && accounts.length === 0" class="error">
        æœªé…ç½®è´¦å·æˆ–æ— æ³•è·å–æ•°æ®ã€‚è¯·æ£€æŸ¥ .env é…ç½®æ–‡ä»¶ã€‚
      </div>
      
      <!-- é¡¹ç›®åœ°å€å’Œç‰ˆæœ¬ä¿¡æ¯ -->
      <div style="text-align: center; padding: 30px 20px;">
        <div style="display: inline-block; background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); padding: 12px 24px; border-radius: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); border: 1px solid rgba(246,150,198,0.3); font-size: 13px; margin-bottom: 15px;">
          <span style="color: #666;">â­ é¡¹ç›®åœ°å€ï¼š</span>
          <a href="https://github.com/jiujiu532/zeabur-monitor" target="_blank" style="color: #f696c6; text-decoration: none; font-weight: 600; margin-left: 5px;">
            github.com/jiujiu532/zeabur-monitor
          </a>
        </div>
        
        <!-- ç‰ˆæœ¬ä¿¡æ¯ -->
        <div style="display: flex; justify-content: center; gap: 10px; flex-wrap: wrap;">
          <div style="background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); padding: 12px 20px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); border: 1px solid rgba(246,150,198,0.2); min-width: 120px; text-align: center;">
            <div style="font-size: 18px; font-weight: 700; color: #f696c6; margin-bottom: 4px;">{{ currentVersion }}</div>
            <div style="font-size: 11px; color: #999;">å½“å‰ç‰ˆæœ¬</div>
          </div>
          
          <div style="background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); padding: 12px 20px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); border: 1px solid rgba(246,150,198,0.2); min-width: 120px; text-align: center;">
            <div style="font-size: 18px; font-weight: 700; color: #f696c6; margin-bottom: 4px;">{{ latestVersion }}</div>
            <div style="font-size: 11px; color: #999;">æœ€æ–°ç‰ˆæœ¬</div>
          </div>
          
          <div style="background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); padding: 12px 20px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); border: 1px solid rgba(246,150,198,0.2); min-width: 120px; text-align: center;">
            <div v-if="versionLoading" style="font-size: 14px; color: #999; margin-bottom: 4px;">â³ æ£€æµ‹ä¸­</div>
            <div v-else-if="isNewVersionAvailable()" style="font-size: 14px; font-weight: 600; color: #ff9800; margin-bottom: 4px;">ğŸ”” éœ€è¦æ›´æ–°</div>
            <div v-else style="font-size: 14px; font-weight: 600; color: #4ade80; margin-bottom: 4px;">âœ“ å·²æ˜¯æœ€æ–°</div>
            <div style="font-size: 11px; color: #999;">æ›´æ–°çŠ¶æ€</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const { createApp } = Vue;
    
    createApp({
      data() {
        return {
          accounts: [],
          loading: false,
          lastUpdate: '--:--:--',
          showAddModal: false,
          showManageModal: false,
          managedAccounts: [],
          projectCosts: {},
          newAccount: {
            name: '',
            token: '',
            balance: ''
          },
          addingAccount: false,
          addAccountError: '',
          addAccountSuccess: '',
          opacity: 39,
          isSummaryWhiteMode: true,
          expandedAccounts: {},
          // åŠ å¯†å¯†é’¥æ£€æŸ¥
          showEncryptionWarning: false,
          suggestedSecret: '',
          // å¯†ç éªŒè¯
          isAuthenticated: false,
          showLoginModal: false,
          showSetPasswordModal: false,
          loginPassword: '',
          loginError: '',
          setPassword: '',
          setPasswordConfirm: '',
          setPasswordError: '',
          // æ‰¹é‡æ·»åŠ 
          batchAccounts: '',
          maskedBatchAccounts: '',
          batchAddError: '',
          batchAddSuccess: '',
          // æ—¥å¿—æ¨¡æ€æ¡†
          showLogsModal: false,
          logsModalTitle: '',
          logsModalInfo: {},
          logsContent: '',
          logsLoading: false,
          // ç‰ˆæœ¬ä¿¡æ¯
          currentVersion: 'åŠ è½½ä¸­...',
          latestVersion: 'åŠ è½½ä¸­...',
          versionLoading: true
        };
      },
      async mounted() {
        // åŠ è½½æ€»è§ˆå¡ç‰‡èƒŒæ™¯æ¨¡å¼è®¾ç½®
        const savedMode = localStorage.getItem('summary_background_mode');
        this.isSummaryWhiteMode = savedMode === null ? true : savedMode === 'white';
        
        // è·å–ç‰ˆæœ¬ä¿¡æ¯ï¼ˆæ— è®ºæ˜¯å¦ç™»å½•éƒ½è·å–ï¼‰
        this.fetchVersionInfo();
        
        // é¦–å…ˆæ£€æŸ¥åŠ å¯†å¯†é’¥æ˜¯å¦å·²è®¾ç½®
        try {
          const encryptionResponse = await fetch('/api/check-encryption');
          const encryptionData = await encryptionResponse.json();
          
          if (!encryptionData.isConfigured) {
            // æœªè®¾ç½®åŠ å¯†å¯†é’¥,æ˜¾ç¤ºè­¦å‘Š
            this.suggestedSecret = encryptionData.suggestedSecret;
            this.showEncryptionWarning = true;
            return; // é˜»æ­¢ç»§ç»­,å¿…é¡»å…ˆè®¾ç½®å¯†é’¥
          }
        } catch (error) {
          console.error('æ£€æŸ¥åŠ å¯†çŠ¶æ€å¤±è´¥:', error);
        }
        
        // æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å·²è®¾ç½®å¯†ç 
        const hasPasswordResponse = await fetch('/api/check-password');
        const { hasPassword } = await hasPasswordResponse.json();
        
        if (!hasPassword) {
          // é¦–æ¬¡ä½¿ç”¨ï¼Œæ˜¾ç¤ºè®¾ç½®å¯†ç ç•Œé¢
          this.showSetPasswordModal = true;
          return;
        }
        
        // æ£€æŸ¥æ˜¯å¦æœ‰æœ‰æ•ˆçš„session token
        const sessionToken = localStorage.getItem('session_token');
        
        if (sessionToken) {
          // å°è¯•ä½¿ç”¨session tokenéªŒè¯
          try {
            const response = await fetch('/api/accounts', {
              headers: { 'x-session-token': sessionToken }
            });
            
            if (response.ok) {
              // Sessionæœ‰æ•ˆï¼Œè‡ªåŠ¨ç™»å½•
              this.isAuthenticated = true;
              await this.loadManagedAccounts();
              this.loadProjectCosts();
              this.fetchData();
              
              // å¯åŠ¨è‡ªåŠ¨åˆ·æ–°
              this.refreshInterval = setInterval(() => this.fetchData(), 90000);
              
              // åŠ è½½é€æ˜åº¦è®¾ç½®
              const savedOpacity = localStorage.getItem('card_opacity');
              if (savedOpacity) {
                this.opacity = parseInt(savedOpacity);
                this.updateOpacity();
              }
              return;
            } else {
              // Sessionæ— æ•ˆï¼Œæ¸…é™¤token
              localStorage.removeItem('session_token');
            }
          } catch (error) {
            console.log('SessionéªŒè¯å¤±è´¥:', error.message);
            localStorage.removeItem('session_token');
          }
        }
        
        // éœ€è¦è¾“å…¥å¯†ç 
        this.showLoginModal = true;
      },
      watch: {
        opacity(newVal) {
          localStorage.setItem('card_opacity', newVal);
          this.updateOpacity();
        }
      },
      beforeUnmount() {
        // æ¸…ç†å®šæ—¶å™¨ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼
        if (this.refreshInterval) {
          clearInterval(this.refreshInterval);
        }
      },
      computed: {
        totalProjects() {
          let total = 0;
          for (const acc of this.accounts) {
            if (acc.projects) total += acc.projects.length;
          }
          return total;
        },
        totalServices() {
          let total = 0;
          for (const acc of this.accounts) {
            if (acc.projects) {
              for (const p of acc.projects) {
                if (p.services) total += p.services.length;
              }
            }
          }
          return total;
        },
        runningServices() {
          let total = 0;
          for (const acc of this.accounts) {
            if (acc.projects) {
              for (const p of acc.projects) {
                if (p.services) {
                  for (const s of p.services) {
                    if (s.status === 'RUNNING') total++;
                  }
                }
              }
            }
          }
          return total;
        },
        totalCost() {
          let total = 0;
          for (const acc of this.accounts) {
            if (acc.projects) {
              for (const p of acc.projects) {
                total += p.cost || 0;
              }
            }
          }
          return total;
        }
      },
      methods: {
        // è®¾ç½®å¯†ç ï¼ˆé¦–æ¬¡ï¼‰
        async setAdminPassword() {
          this.setPasswordError = '';
          
          if (!this.setPassword || this.setPassword.length < 6) {
            this.setPasswordError = 'å¯†ç é•¿åº¦è‡³å°‘6ä½';
            return;
          }
          
          if (this.setPassword !== this.setPasswordConfirm) {
            this.setPasswordError = 'ä¸¤æ¬¡è¾“å…¥çš„å¯†ç ä¸ä¸€è‡´';
            return;
          }
          
          try {
            const response = await fetch('/api/set-password', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ password: this.setPassword })
            });
            
            const result = await response.json();
            if (result.success) {
              // è®¾ç½®æˆåŠŸï¼Œéœ€è¦ç™»å½•è·å–session token
              this.loginPassword = this.setPassword;
              this.showSetPasswordModal = false;
              
              // è‡ªåŠ¨éªŒè¯å¯†ç è·å–session token
              await this.verifyPassword();
              
              // åŠ è½½é€æ˜åº¦è®¾ç½®
              const savedOpacity = localStorage.getItem('card_opacity');
              if (savedOpacity) {
                this.opacity = parseInt(savedOpacity);
                this.updateOpacity();
              }
            } else {
              this.setPasswordError = result.error || 'è®¾ç½®å¤±è´¥';
            }
          } catch (error) {
            this.setPasswordError = 'è®¾ç½®å¤±è´¥: ' + error.message;
          }
        },
        // éªŒè¯å¯†ç 
        async verifyPassword() {
          this.loginError = '';
          try {
            const response = await fetch('/api/verify-password', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ password: this.loginPassword })
            });
            
            const result = await response.json();
            if (result.success) {
              this.isAuthenticated = true;
              this.showLoginModal = false;
              
              // ä¿å­˜session token (2å¤©æœ‰æ•ˆæœŸ,è·¨æµè§ˆå™¨)
              localStorage.setItem('session_token', result.sessionToken);
              
              await this.loadManagedAccounts();
              this.loadProjectCosts();
              this.fetchData();
              
              // å¯åŠ¨è‡ªåŠ¨åˆ·æ–°
              this.refreshInterval = setInterval(() => this.fetchData(), 90000);
              
              // åŠ è½½é€æ˜åº¦è®¾ç½®
              const savedOpacity = localStorage.getItem('card_opacity');
              if (savedOpacity) {
                this.opacity = parseInt(savedOpacity);
                this.updateOpacity();
              }
            } else {
              this.loginError = 'å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•';
            }
          } catch (error) {
            this.loginError = 'éªŒè¯å¤±è´¥: ' + error.message;
          }
        },
        // é‚®ç®±æ‰“ç 
        maskEmail(email) {
          if (!email || !email.includes('@')) return email;
          const [local, domain] = email.split('@');
          if (local.length <= 4) return email;
          const masked = local.substring(0, 2) + 'x'.repeat(local.length - 4) + local.substring(local.length - 2);
          return masked + '@' + domain;
        },
        // è·å–è¯·æ±‚å¤´ï¼ˆåŒ…å«session tokenï¼‰
        getAuthHeaders() {
          const sessionToken = localStorage.getItem('session_token');
          return {
            'Content-Type': 'application/json',
            'x-session-token': sessionToken
          };
        },
        // å¤„ç†401é”™è¯¯ï¼Œè‡ªåŠ¨å¼¹å‡ºç™»å½•æ¡†
        handleUnauthorized() {
          console.log('âš ï¸ Sessionå·²è¿‡æœŸï¼Œéœ€è¦é‡æ–°ç™»å½•');
          localStorage.removeItem('session_token');
          this.isAuthenticated = false;
          this.showLoginModal = true;
        },
        async loadManagedAccounts() {
          try {
            // ä»æœåŠ¡å™¨åŠ è½½è´¦å·
            const response = await fetch('/api/server-accounts', {
              headers: this.getAuthHeaders()
            });
            
            // æ£€æŸ¥401é”™è¯¯
            if (response.status === 401) {
              this.handleUnauthorized();
              return;
            }
            
            const accounts = await response.json();
            if (accounts && accounts.length > 0) {
              this.managedAccounts = accounts;
              console.log(`ğŸ“‹ ä»æœåŠ¡å™¨åŠ è½½ ${accounts.length} ä¸ªè´¦å·`);
            }
          } catch (error) {
            console.log('âš ï¸ ä»æœåŠ¡å™¨åŠ è½½è´¦å·å¤±è´¥:', error.message);
          }
        },
        async saveManagedAccounts() {
          try {
            // ä¿å­˜åˆ°æœåŠ¡å™¨
            const response = await fetch('/api/server-accounts', {
              method: 'POST',
              headers: this.getAuthHeaders(),
              body: JSON.stringify({ accounts: this.managedAccounts })
            });
            
            // æ£€æŸ¥401é”™è¯¯
            if (response.status === 401) {
              this.handleUnauthorized();
              return;
            }
            
            const result = await response.json();
            if (result.success) {
              console.log('âœ… è´¦å·å·²ä¿å­˜åˆ°æœåŠ¡å™¨');
            }
          } catch (error) {
            console.error('âŒ ä¿å­˜è´¦å·åˆ°æœåŠ¡å™¨å¤±è´¥:', error.message);
          }
        },
        loadProjectCosts() {
          const saved = localStorage.getItem('zeabur_project_costs');
          if (saved) {
            this.projectCosts = JSON.parse(saved);
          }
        },

        async fetchData() {
          this.loading = true;
          try {
            // å¦‚æœæœ‰è´¦å·ï¼Œä½¿ç”¨è´¦å·
            if (this.managedAccounts.length > 0) {
              // æ¸…é™¤è´¦å·ä¸­çš„æ‰‹åŠ¨ä½™é¢ï¼Œè®©æœåŠ¡å™¨ä½¿ç”¨ API çœŸå®æ•°æ®
              const accountsWithoutManualBalance = this.managedAccounts.map(acc => ({
                ...acc,
                balance: null // ä¸å‘é€æ‰‹åŠ¨ä½™é¢
              }));
              
              const [accountsRes, projectsRes] = await Promise.all([
                fetch('/api/temp-accounts', {
                  method: 'POST',
                  headers: this.getAuthHeaders(),
                  body: JSON.stringify({ accounts: accountsWithoutManualBalance })
                }).then(r => r.json()),
                fetch('/api/temp-projects', {
                  method: 'POST',
                  headers: this.getAuthHeaders(),
                  body: JSON.stringify({ 
                    accounts: accountsWithoutManualBalance,
                    projectCosts: {} // ä¸å‘é€æ‰‹åŠ¨è´¹ç”¨ï¼Œè®©æœåŠ¡å™¨å°è¯•ä» API è·å–
                  })
                }).then(r => r.json())
              ]);
              
              console.log('API è¿”å›çš„è´¦å·æ•°æ®:', accountsRes);
              console.log('API è¿”å›çš„é¡¹ç›®æ•°æ®:', projectsRes);
              
              this.accounts = accountsRes.map((account, index) => {
                const projectData = projectsRes[index];
                console.log(`è´¦å· ${account.name} ä½™é¢: ${account.data?.credit} (${account.data?.credit/100} USD)`);
                return {
                  ...account,
                  projects: projectData.projects || []
                };
              });
            } else {
              // å¦åˆ™ä½¿ç”¨æœåŠ¡å™¨é…ç½®çš„è´¦å·
              const [accountsRes, projectsRes] = await Promise.all([
                fetch('/api/accounts').then(r => r.json()),
                fetch('/api/projects').then(r => r.json())
              ]);
              
              this.accounts = accountsRes.map((account, index) => {
                const projectData = projectsRes[index];
                return {
                  ...account,
                  projects: projectData.projects || []
                };
              });
            }
          } catch (error) {
            console.error('è·å–æ•°æ®å¤±è´¥:', error);
            alert('è·å–æ•°æ®å¤±è´¥: ' + error.message);
          } finally {
            this.loading = false;
            this.lastUpdate = new Date().toLocaleTimeString('zh-CN');
          }
        },
        getBalanceClass(credit) {
          const balance = credit / 100;
          if (balance < 10) return 'critical';
          if (balance < 50) return 'low';
          return '';
        },
        async batchAddAccounts() {
          this.batchAddError = '';
          this.batchAddSuccess = '';
          
          if (!this.batchAccounts.trim()) {
            this.batchAddError = 'è¯·è¾“å…¥è´¦å·ä¿¡æ¯';
            return;
          }
          
          const lines = this.batchAccounts.trim().split('\n');
          const accounts = [];
          
          // è§£ææ¯ä¸€è¡Œ
          for (let i = 0; i < lines.length; i++) {
            const line = lines[i].trim();
            if (!line) continue;
            
            let name = '';
            let token = '';
            
            // å°è¯•åŒ¹é…æ‹¬å·æ ¼å¼ï¼šåç§°(token) æˆ– åç§°ï¼ˆtokenï¼‰
            const bracketMatch = line.match(/^(.+?)[ï¼ˆ(](.+?)[ï¼‰)]$/);
            if (bracketMatch) {
              name = bracketMatch[1].trim();
              token = bracketMatch[2].trim();
            } else if (line.includes(':')) {
              // å†’å·æ ¼å¼ï¼šåç§°:token
              const parts = line.split(':');
              name = parts[0].trim();
              token = parts.slice(1).join(':').trim();
            } else if (line.includes('ï¼š')) {
              // ä¸­æ–‡å†’å·æ ¼å¼ï¼šåç§°ï¼štoken
              const parts = line.split('ï¼š');
              name = parts[0].trim();
              token = parts.slice(1).join('ï¼š').trim();
            } else {
              this.batchAddError = `ç¬¬ ${i + 1} è¡Œæ ¼å¼é”™è¯¯ï¼Œæ”¯æŒçš„æ ¼å¼ï¼šåç§°:Token æˆ– åç§°ï¼šToken æˆ– åç§°(Token) æˆ– åç§°ï¼ˆTokenï¼‰`;
              return;
            }
            
            if (!name || !token) {
              this.batchAddError = `ç¬¬ ${i + 1} è¡Œï¼šè´¦å·åç§°æˆ– Token ä¸èƒ½ä¸ºç©º`;
              return;
            }
            
            accounts.push({ name, token });
          }
          
          if (accounts.length === 0) {
            this.batchAddError = 'æ²¡æœ‰æœ‰æ•ˆçš„è´¦å·ä¿¡æ¯';
            return;
          }
          
          this.addingAccount = true;
          let successCount = 0;
          let failedAccounts = [];
          
          // é€ä¸ªéªŒè¯å¹¶æ·»åŠ 
          for (const account of accounts) {
            try {
              const response = await fetch('/api/validate-account', {
                method: 'POST',
                headers: this.getAuthHeaders(),
                body: JSON.stringify({
                  accountName: account.name,
                  apiToken: account.token
                })
              });
              
              const data = await response.json();
              
              if (response.ok) {
                // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
                const exists = this.managedAccounts.some(acc => acc.name === account.name);
                if (!exists) {
                  this.managedAccounts.push({
                    name: account.name,
                    token: account.token,
                    email: data.userData.email,
                    username: data.userData.username
                  });
                  successCount++;
                } else {
                  failedAccounts.push(`${account.name}ï¼ˆå·²å­˜åœ¨ï¼‰`);
                }
              } else {
                failedAccounts.push(`${account.name}ï¼ˆ${data.error || 'éªŒè¯å¤±è´¥'}ï¼‰`);
              }
            } catch (error) {
              failedAccounts.push(`${account.name}ï¼ˆç½‘ç»œé”™è¯¯ï¼‰`);
            }
          }
          
          this.addingAccount = false;
          
          if (successCount > 0) {
            await this.saveManagedAccounts();
            this.fetchData();
          }
          
          // æ˜¾ç¤ºç»“æœ
          if (successCount > 0 && failedAccounts.length === 0) {
            this.batchAddSuccess = `âœ… æˆåŠŸæ·»åŠ  ${successCount} ä¸ªè´¦å·`;
            this.batchAccounts = '';
            this.maskedBatchAccounts = '';
          } else if (successCount > 0) {
            this.batchAddSuccess = `âœ… æˆåŠŸæ·»åŠ  ${successCount} ä¸ªè´¦å·`;
            this.batchAddError = `âŒ å¤±è´¥: ${failedAccounts.join(', ')}`;
          } else {
            this.batchAddError = `âŒ å…¨éƒ¨å¤±è´¥: ${failedAccounts.join(', ')}`;
          }
          
          // 3ç§’åæ¸…é™¤æç¤º
          setTimeout(() => {
            this.batchAddSuccess = '';
            if (successCount > 0 && failedAccounts.length === 0) {
              this.batchAddError = '';
            }
          }, 3000);
        },
        async addAccountToList() {
          if (!this.newAccount.name || !this.newAccount.token) {
            this.addAccountError = 'è¯·å¡«å†™è´¦å·åç§°å’Œ API Token';
            return;
          }
          
          this.addingAccount = true;
          this.addAccountError = '';
          this.addAccountSuccess = '';
          
          try {
            const response = await fetch('/api/validate-account', {
              method: 'POST',
              headers: this.getAuthHeaders(),
              body: JSON.stringify({
                accountName: this.newAccount.name,
                apiToken: this.newAccount.token
              })
            });
            
            // æ£€æŸ¥401é”™è¯¯
            if (response.status === 401) {
              this.handleUnauthorized();
              return;
            }
            
            const data = await response.json();
            
            if (response.ok) {
              // æ·»åŠ åˆ°æœ¬åœ°åˆ—è¡¨
              this.managedAccounts.push({
                name: this.newAccount.name,
                token: this.newAccount.token,
                balance: this.newAccount.balance ? parseFloat(this.newAccount.balance) : null,
                email: data.userData.email,
                username: data.userData.username
              });
              
              this.saveManagedAccounts();
              this.addAccountSuccess = `âœ… è´¦å·æ·»åŠ æˆåŠŸï¼ç”¨æˆ·: ${data.userData.username}`;
              
              // æ¸…ç©ºè¡¨å•
              this.newAccount = { name: '', token: '', balance: '' };
              
              // åˆ·æ–°æ•°æ®
              setTimeout(() => {
                this.fetchData();
                this.addAccountSuccess = '';
              }, 1500);
            } else {
              this.addAccountError = data.error || 'æ·»åŠ å¤±è´¥';
            }
          } catch (error) {
            this.addAccountError = 'ç½‘ç»œé”™è¯¯: ' + error.message;
          } finally {
            this.addingAccount = false;
          }
        },
        async removeAccount(index) {
          const accountName = this.managedAccounts[index].name;
          const password = prompt(`åˆ é™¤è´¦å·"${accountName}"éœ€è¦éªŒè¯ç®¡ç†å‘˜å¯†ç ï¼š`);
          
          if (!password) return;
          
          // éªŒè¯å¯†ç 
          try {
            const response = await fetch('/api/verify-password', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({ password })
            });
            
            const result = await response.json();
            if (result.success) {
              this.managedAccounts.splice(index, 1);
              await this.saveManagedAccounts();
              this.fetchData();
              alert('è´¦å·å·²åˆ é™¤');
            } else {
              alert('å¯†ç é”™è¯¯ï¼Œåˆ é™¤å¤±è´¥');
            }
          } catch (error) {
            alert('éªŒè¯å¤±è´¥: ' + error.message);
          }
        },
        closeAddModal() {
          this.showAddModal = false;
          this.newAccount = { name: '', token: '', balance: '' };
          this.addAccountError = '';
          this.addAccountSuccess = '';
        },
        closeManageModal() {
          this.showManageModal = false;
          this.newAccount = { name: '', token: '', balance: '' };
          this.addAccountError = '';
          this.addAccountSuccess = '';
        },
        updateOpacity() {
          const opacity = this.opacity / 100;
          const root = document.documentElement;
          if (!root) return; // é˜²æ­¢ DOM æœªåŠ è½½
          
          // è®¾ç½®æ‰€æœ‰ç›¸å…³çš„CSSå˜é‡
          root.style.setProperty('--card-opacity', opacity);
          root.style.setProperty('--service-opacity', Math.min(opacity + 0.05, 1));
          root.style.setProperty('--blur-amount', `${20 * opacity}px`);
          root.style.setProperty('--blur-amount-small', `${15 * opacity}px`);
          root.style.setProperty('--blur-amount-tiny', `${10 * opacity}px`);
          root.style.setProperty('--saturate-amount', `${100 + 80 * opacity}%`);
          root.style.setProperty('--shadow-opacity', 0.1 * opacity);
          root.style.setProperty('--shadow-opacity-light', 0.05 * opacity);
          root.style.setProperty('--border-opacity', 0.3 * opacity);
          root.style.setProperty('--border-opacity-light', 0.4 * opacity);
          root.style.setProperty('--border-opacity-strong', 0.5 * opacity);
        },
        clearCache() {
          if (confirm('ç¡®å®šè¦æ¸…é™¤æ‰€æœ‰ç¼“å­˜æ•°æ®å—ï¼Ÿè¿™å°†åˆ é™¤æ‰€æœ‰æœ¬åœ°ä¿å­˜çš„è´¦å·ã€ä½™é¢å’Œè´¹ç”¨æ•°æ®ã€‚')) {
            // æ¸…é™¤æ‰€æœ‰æœ¬åœ°æ•°æ®
            this.managedAccounts = [];
            this.projectCosts = {};
            localStorage.removeItem('zeabur_accounts');
            localStorage.removeItem('zeabur_project_costs');
            
            alert('ç¼“å­˜å·²æ¸…é™¤ï¼æ­£åœ¨é‡æ–°è·å–æ•°æ®...');
            this.fetchData();
          }
        },
        toggleSummaryBackground() {
          this.isSummaryWhiteMode = !this.isSummaryWhiteMode;
          localStorage.setItem('summary_background_mode', this.isSummaryWhiteMode ? 'white' : 'pink');
        },
        toggleAccount(accountName) {
          this.expandedAccounts[accountName] = !this.expandedAccounts[accountName];
        },
        isAccountExpanded(accountName) {
          return this.expandedAccounts[accountName] !== false;
        },
        // æš‚åœæœåŠ¡
        async pauseService(account, project, service) {
          if (!confirm(`ç¡®å®šè¦æš‚åœæœåŠ¡"${service.name}"å—ï¼Ÿ`)) return;
          
          try {
            // è·å–ç¯å¢ƒ ID
            const environmentId = project.environments && project.environments[0] ? project.environments[0]._id : null;
            if (!environmentId) {
              alert('âŒ æ— æ³•è·å–ç¯å¢ƒ IDï¼Œè¯·åˆ·æ–°é¡µé¢åé‡è¯•');
              return;
            }
            
            // è·å–è´¦å· token
            const accountData = this.managedAccounts.find(acc => acc.name === account.name);
            if (!accountData || !accountData.token) {
              alert('âŒ æ— æ³•è·å–è´¦å· tokenï¼Œè¯·é‡æ–°æ·»åŠ è´¦å·');
              return;
            }
            
            const response = await fetch('/api/service/pause', {
              method: 'POST',
              headers: this.getAuthHeaders(),
              body: JSON.stringify({ 
                token: accountData.token, 
                serviceId: service._id,
                environmentId: environmentId
              })
            });
            
            const result = await response.json();
            if (result.success) {
              alert('âœ… æœåŠ¡å·²æš‚åœ');
              this.fetchData();
            } else {
              alert('âŒ æš‚åœå¤±è´¥: ' + (result.error || JSON.stringify(result)));
            }
          } catch (error) {
            alert('âŒ æ“ä½œå¤±è´¥: ' + error.message);
          }
        },
        // é‡å¯æœåŠ¡
        async restartService(account, project, service) {
          const action = service.status === 'SUSPENDED' ? 'å¯åŠ¨' : 'é‡å¯';
          if (!confirm(`ç¡®å®šè¦${action}æœåŠ¡"${service.name}"å—ï¼Ÿ`)) return;
          
          try {
            // è·å–ç¯å¢ƒ ID
            const environmentId = project.environments && project.environments[0] ? project.environments[0]._id : null;
            if (!environmentId) {
              alert('âŒ æ— æ³•è·å–ç¯å¢ƒ IDï¼Œè¯·åˆ·æ–°é¡µé¢åé‡è¯•');
              return;
            }
            
            // è·å–è´¦å· token
            const accountData = this.managedAccounts.find(acc => acc.name === account.name);
            if (!accountData || !accountData.token) {
              alert('âŒ æ— æ³•è·å–è´¦å· tokenï¼Œè¯·é‡æ–°æ·»åŠ è´¦å·');
              return;
            }
            
            const response = await fetch('/api/service/restart', {
              method: 'POST',
              headers: this.getAuthHeaders(),
              body: JSON.stringify({ 
                token: accountData.token, 
                serviceId: service._id,
                environmentId: environmentId
              })
            });
            
            const result = await response.json();
            if (result.success) {
              alert(`âœ… æœåŠ¡å·²${action}`);
              this.fetchData();
            } else {
              alert(`âŒ ${action}å¤±è´¥: ` + (result.error || JSON.stringify(result)));
            }
          } catch (error) {
            alert('âŒ æ“ä½œå¤±è´¥: ' + error.message);
          }
        },
        // æŸ¥çœ‹æœåŠ¡æ—¥å¿—
        async showServiceLogs(account, project, service) {
          this.logsModalTitle = 'æœåŠ¡æ—¥å¿— - ' + service.name;
          this.logsModalInfo = { project: project.name, account: account.name, count: 0, time: new Date().toLocaleString('zh-CN') };
          this.logsContent = '';
          this.logsLoading = true;
          this.showLogsModal = true;
          
          try {
            const environmentId = project.environments && project.environments[0] ? project.environments[0]._id : null;
            if (!environmentId) { this.logsContent = 'âŒ æ— æ³•è·å–ç¯å¢ƒ ID'; this.logsLoading = false; return; }
            
            const accountData = this.managedAccounts.find(acc => acc.name === account.name);
            if (!accountData || !accountData.token) { this.logsContent = 'âŒ æ— æ³•è·å–è´¦å· token'; this.logsLoading = false; return; }
            
            const response = await fetch('/api/service/logs', {
              method: 'POST',
              headers: this.getAuthHeaders(),
              body: JSON.stringify({ token: accountData.token, serviceId: service._id, environmentId: environmentId, projectId: project._id, limit: 200 })
            });
            
            const result = await response.json();
            if (result.success && result.logs) {
              this.logsContent = result.logs.map(log => '[' + new Date(log.timestamp).toLocaleString('zh-CN') + '] ' + log.message).join('\n');
              this.logsModalInfo.count = result.count;
            } else {
              this.logsContent = 'âŒ è·å–æ—¥å¿—å¤±è´¥: ' + (result.error || 'æœªçŸ¥é”™è¯¯');
            }
          } catch (error) {
            this.logsContent = 'âŒ è·å–æ—¥å¿—å¤±è´¥: ' + error.message;
          } finally {
            this.logsLoading = false;
          }
        },
        // æ ¼å¼åŒ–è´¹ç”¨æ˜¾ç¤ºï¼ˆå°äº $0.01 æ˜¾ç¤ºä¸º $0.01ï¼‰
        formatCost(cost) {
          if (cost > 0 && cost < 0.01) {
            return '0.01';
          }
          return cost.toFixed(2);
        },
        // æ›´æ–°æ‰¹é‡æ·»åŠ çš„æ‰“ç æ˜¾ç¤º
        updateBatchDisplay() {
          if (!this.batchAccounts) {
            this.maskedBatchAccounts = '';
            return;
          }
          const lines = this.batchAccounts.split('\n');
          this.maskedBatchAccounts = lines.map(line => {
            // å°è¯•åŒ¹é…æ‹¬å·æ ¼å¼ï¼šåç§°(token) æˆ– åç§°ï¼ˆtokenï¼‰
            const bracketMatch = line.match(/^(.+?)[ï¼ˆ(](.+?)[ï¼‰)]$/);
            if (bracketMatch) {
              const name = bracketMatch[1];
              const bracket = line.includes('ï¼ˆ') ? 'ï¼ˆ' : '(';
              const closeBracket = line.includes('ï¼‰') ? 'ï¼‰' : ')';
              const maskedToken = bracketMatch[2].replace(/./g, 'â—');
              return name + bracket + maskedToken + closeBracket;
            }
            
            // å†’å·æ ¼å¼
            let separatorIndex = -1;
            let separator = '';
            
            if (line.includes(':')) {
              separatorIndex = line.indexOf(':');
              separator = ':';
            } else if (line.includes('ï¼š')) {
              separatorIndex = line.indexOf('ï¼š');
              separator = 'ï¼š';
            }
            
            if (separatorIndex === -1) return line;
            
            const name = line.substring(0, separatorIndex);
            const token = line.substring(separatorIndex + 1);
            return name + separator + token.replace(/./g, 'â—');
          }).join('\n');
        },
        // è·å–é¡¹ç›®çš„æ‰€æœ‰åŸŸå
        getProjectDomains(project) {
          const domains = [];
          if (project.services) {
            project.services.forEach(service => {
              if (service.domains && service.domains.length > 0) {
                service.domains.forEach(d => {
                  if (d.domain) {
                    domains.push({
                      domain: d.domain,
                      isGenerated: d.isGenerated || false
                    });
                  }
                });
              }
            });
          }
          return domains;
        },
        // å¼€å§‹ç¼–è¾‘é¡¹ç›®åç§°
        startEditProjectName(project) {
          project.isEditing = true;
          project.editingName = project.name;
          setTimeout(() => {
            const inputs = document.querySelectorAll('input[type="text"]');
            const lastInput = inputs[inputs.length - 1];
            if (lastInput) lastInput.focus();
          }, 50);
        },
        // å–æ¶ˆç¼–è¾‘é¡¹ç›®åç§°
        cancelEditProjectName(project) {
          project.isEditing = false;
          project.editingName = '';
        },
        // ä¿å­˜é¡¹ç›®åç§°
        async saveProjectName(account, project) {
          // å¦‚æœä¸åœ¨ç¼–è¾‘çŠ¶æ€ï¼Œç›´æ¥è¿”å›ï¼ˆé¿å… blur äº‹ä»¶é‡å¤è§¦å‘ï¼‰
          if (!project.isEditing) {
            return;
          }
          
          if (!project.editingName || project.editingName.trim() === '') {
            alert('âŒ é¡¹ç›®åç§°ä¸èƒ½ä¸ºç©º');
            return;
          }
          
          if (project.editingName === project.name) {
            this.cancelEditProjectName(project);
            return;
          }
          
          try {
            const accountData = this.managedAccounts.find(acc => acc.name === account.name);
            if (!accountData) {
              alert('âŒ æ— æ³•æ‰¾åˆ°è´¦å·ä¿¡æ¯ï¼Œè¯·é‡æ–°æ·»åŠ è´¦å·');
              return;
            }
            
            const response = await fetch('/api/project/rename', {
              method: 'POST',
              headers: this.getAuthHeaders(),
              body: JSON.stringify({ 
                accountId: accountData.id || accountData.name,
                projectId: project._id,
                newName: project.editingName.trim()
              })
            });
            
            const result = await response.json();
            if (result.success) {
              project.name = project.editingName.trim();
              this.cancelEditProjectName(project);
              alert('âœ… é¡¹ç›®åç§°å·²æ›´æ–°');
            } else {
              alert('âŒ æ›´æ–°å¤±è´¥: ' + (result.error || 'æœªçŸ¥é”™è¯¯'));
            }
          } catch (error) {
            alert('âŒ æ“ä½œå¤±è´¥: ' + error.message);
          }
        },
        // è·å–ç‰ˆæœ¬ä¿¡æ¯
        // å¤åˆ¶åŠ å¯†å¯†é’¥åˆ°å‰ªè´´æ¿
        async copySecret() {
          try {
            await navigator.clipboard.writeText(this.suggestedSecret);
            alert('å¯†é’¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿!è¯·æŒ‰ç…§æ­¥éª¤è®¾ç½®ååˆ·æ–°é¡µé¢ã€‚');
          } catch (error) {
            // é™çº§æ–¹æ¡ˆ
            const textArea = document.createElement('textarea');
            textArea.value = this.suggestedSecret;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            alert('å¯†é’¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿!è¯·æŒ‰ç…§æ­¥éª¤è®¾ç½®ååˆ·æ–°é¡µé¢ã€‚');
          }
        },
        async fetchVersionInfo() {
          try {
            console.log('å¼€å§‹è·å–ç‰ˆæœ¬ä¿¡æ¯...');
            const [currentRes, latestRes] = await Promise.all([
              fetch('/api/version'),
              fetch('/api/latest-version')
            ]);
            
            const current = await currentRes.json();
            const latest = await latestRes.json();
            
            console.log('å½“å‰ç‰ˆæœ¬:', current.version);
            console.log('æœ€æ–°ç‰ˆæœ¬:', latest.version);
            
            this.currentVersion = current.version || '--';
            this.latestVersion = latest.version || '--';
            this.versionLoading = false;
          } catch (error) {
            console.error('è·å–ç‰ˆæœ¬ä¿¡æ¯å¤±è´¥:', error);
            this.currentVersion = '--';
            this.latestVersion = '--';
            this.versionLoading = false;
          }
        },
        // æ¯”è¾ƒç‰ˆæœ¬å·
        isNewVersionAvailable() {
          if (this.currentVersion === '--' || this.latestVersion === '--' || 
              this.currentVersion === 'åŠ è½½ä¸­...' || this.latestVersion === 'åŠ è½½ä¸­...') {
            return false;
          }
          
          const parseCurrent = this.currentVersion.split('.').map(Number);
          const parseLatest = this.latestVersion.split('.').map(Number);
          
          for (let i = 0; i < 3; i++) {
            const current = parseCurrent[i] || 0;
            const latest = parseLatest[i] || 0;
            
            if (latest > current) {
              return true;
            } else if (latest < current) {
              return false;
            }
          }
          
          return false;
        },
        
        // è®¡ç®—è´¦å·ä¸‹æ‰€æœ‰æœåŠ¡æ•°é‡
        getTotalServices(account) {
          if (!account.projects) return 0;
          
          let total = 0;
          account.projects.forEach(project => {
            if (project.services) {
              total += project.services.length;
            }
          });
          
          return total;
        },
        
        // è®¡ç®—è´¦å·ä¸‹è¿è¡Œä¸­çš„æœåŠ¡æ•°é‡
        getRunningServices(account) {
          if (!account.projects) return 0;
          
          let running = 0;
          account.projects.forEach(project => {
            if (project.services) {
              project.services.forEach(service => {
                if (service.status === 'RUNNING') {
                  running++;
                }
              });
            }
          });
          
          return running;
        }
      }
    }).mount('#app');
  </script>

</body>
</html>
